# TON Tracker Bot

Telegram-–±–æ—Ç –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è TON-–∫–æ—à–µ–ª—å–∫–æ–≤ —Å –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–æ–≤** ‚Äî –¥–æ–±–∞–≤–ª—è–π—Ç–µ TON-–∞–¥—Ä–µ—Å–∞ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–µ—Ä–µ–≤–æ–¥–∞—Ö** ‚Äî –≤—Ö–æ–¥—è—â–∏–µ –∏ –∏—Å—Ö–æ–¥—è—â–∏–µ TON-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–≤–æ–ø–∞—Ö** ‚Äî –æ–±–º–µ–Ω—ã –Ω–∞ DEX (STON.fi, DeDust, Megaton)
- **–§–∏–ª—å—Ç—Ä—ã** ‚Äî –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ —Å—É–º–º—ã
- **Premium** ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Webhooks** ‚Äî –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ TonAPI webhooks

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
ton-tracker/
‚îú‚îÄ‚îÄ cmd/bot/              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ config/           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ ENV
‚îÇ   ‚îú‚îÄ‚îÄ storage/          # SQLite —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
‚îÇ   ‚îú‚îÄ‚îÄ tonapi/           # –ö–ª–∏–µ–Ω—Ç TonAPI
‚îÇ   ‚îú‚îÄ‚îÄ telegram/         # Telegram –±–æ—Ç –∏ —Ö–µ–Ω–¥–ª–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ webhook/          # HTTP —Å–µ—Ä–≤–µ—Ä –¥–ª—è webhooks
‚îÇ   ‚îî‚îÄ‚îÄ notifier/         # –õ–æ–≥–∏–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îî‚îÄ‚îÄ migrations/           # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
```

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Go 1.22+** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫
- **SQLite** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **TonAPI** ‚Äî –±–ª–æ–∫—á–µ–π–Ω API
- **go-telegram/bot** ‚Äî Telegram Bot API

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Go 1.22+
- TonAPI –∫–ª—é—á (https://tonapi.io)
- Telegram Bot Token ([@BotFather](https://t.me/BotFather))

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/suspectuso/ton-tracker.git
cd ton-tracker

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
go mod download

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥
cp .env.example .env
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env`:

```env
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
BOT_TOKEN=your_telegram_bot_token
TONAPI_API_KEY=your_tonapi_key

# Webhook (–¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)
WEBHOOK_ENDPOINT=https://your-domain.com/webhook
WEBHOOK_PORT=8080

# Premium (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
SERVICE_WALLET_ADDR=UQYour_Wallet
PREMIUM_PRICE_TON=5
```

### –ó–∞–ø—É—Å–∫

```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
make run

# –°–±–æ—Ä–∫–∞
make build
./ton-tracker

# Docker
docker build -t ton-tracker .
docker run -d --env-file .env -p 8080:8080 ton-tracker
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` ‚Äî –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/me` ‚Äî –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### Inline-–∫–Ω–æ–ø–∫–∏

- **‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–æ—à–µ–ª—ë–∫** ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∞–¥—Ä–µ—Å
- **üìã –°–ø–∏—Å–æ–∫ –∫–æ—à–µ–ª—å–∫–æ–≤** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞–º–∏
- **‚≠ê Premium** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Premium

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ—à–µ–ª—å–∫–∞

- **‚¨áÔ∏è –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞** ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- **‚ôªÔ∏è –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã** ‚Äî —Å–±—Ä–æ—Å –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

## API

### TonAPI Webhooks

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TonAPI webhooks –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:

1. –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è/–Ω–∞—Ö–æ–¥–∏—Ç—Å—è webhook —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º `WEBHOOK_ENDPOINT`
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–æ–∫ —Å –∫–æ—à–µ–ª—å–∫–∞–º–∏ –≤ –ë–î
3. –í—Ö–æ–¥—è—â–∏–µ —Å–æ–±—ã—Ç–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

### Endpoints

- `POST /webhook` ‚Äî –ø—Ä–∏—ë–º —Å–æ–±—ã—Ç–∏–π –æ—Ç TonAPI
- `GET /health` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

SQLite —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏:

- `wallets` ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ –∫–æ—à–µ–ª—å–∫–∏
- `processed_events` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (–¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è)
- `premium_users` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å Premium
- `premium_payments` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
- `pending_premium_payments` ‚Äî –æ–∂–∏–¥–∞—é—â–∏–µ –ø–ª–∞—Ç–µ–∂–∏

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Systemd

```ini
[Unit]
Description=TON Tracker Bot
After=network.target

[Service]
Type=simple
User=tracker
WorkingDirectory=/opt/ton-tracker
ExecStart=/opt/ton-tracker/ton-tracker
Restart=always
RestartSec=5
EnvironmentFile=/opt/ton-tracker/.env

[Install]
WantedBy=multi-user.target
```

### Docker Compose

```yaml
version: '3.8'
services:
  bot:
    build: .
    restart: always
    env_file: .env
    ports:
      - "8080:8080"
    volumes:
      - ./data:/app/data
```

### Nginx (–¥–ª—è webhook)

```nginx
location /webhook {
    proxy_pass http://127.0.0.1:8080;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
}
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

| –ü–∞–∫–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| `config` | –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è |
| `storage` | –°–ª–æ–π —Ä–∞–±–æ—Ç—ã —Å SQLite (—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π) |
| `tonapi` | HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è TonAPI —Å rate limiting |
| `telegram` | Telegram –±–æ—Ç, —Ö–µ–Ω–¥–ª–µ—Ä—ã, –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã, FSM |
| `webhook` | HTTP —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–∏—ë–º–∞ webhooks, –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–¥–ø–∏—Å–æ–∫ |
| `notifier` | –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π |

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## –ê–≤—Ç–æ—Ä

[@suspectuso](https://github.com/suspectuso)
